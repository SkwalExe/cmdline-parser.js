!function(f){"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define([],f):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).CmdLineParser=f()}(function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){void 0!==module&&(module.exports=class{constructor(aamp=!0,gt=!0,ppipe=!0,pipe=!0,ggt=!0,lt=!0,llt=!0){this.tokens=[],aamp&&this.tokens.push("&&"),ppipe&&this.tokens.push("||"),pipe&&this.tokens.push("|"),ggt&&this.tokens.push(">>"),gt&&this.tokens.push(">"),llt&&this.tokens.push("<<"),lt&&this.tokens.push("<"),this.utils=require("./utils"),this.Command=class{constructor(){this.invalid=!1,this.invalidReason=null,this.args=[],this[">"]=[],this["&&"]=null,this["||"]=null,this["|"]=null,this[">>"]=[],this["<"]=[],this["<<"]=[],this.name=null,this.text=null}},this.parseCommands=commands=>{let parsedCommands=[];return commands.forEach(command=>parsedCommands.push(this.parseCommand(command))),parsedCommands},this.parse=commandLine=>{let semicolonIndexes=this.utils.getAllOccurrencesOf(";",commandLine);return semicolonIndexes=semicolonIndexes.filter(index=>!this.utils.isBetweenQuotes(commandLine,index)),this.parseCommands(this.utils.splitAt(semicolonIndexes,commandLine))},this.parseCommand=string=>{string=string.trim();let commandObject=new this.Command,command="",writeTo="command",ignoreNextChar=!1,gtIndex=-1,gtgtIndex=-1,ltIndex=-1,ltltIndex=-1;commandObject.text=string;for(let i=0;i<string.length;i++)if(ignoreNextChar)ignoreNextChar=!1;else{var char=string[i];if(this.tokens.some(token=>string.substring(i).startsWith(token))&&!this.utils.isBetweenQuotes(string,i)){var token=this.tokens.find(token=>string.substring(i).startsWith(token));if(">"===token)writeTo=">",gtIndex++,commandObject[">"][gtIndex]="";else if(">>"===token)ignoreNextChar=!0,writeTo=">>",gtgtIndex++,commandObject[">>"][gtgtIndex]="";else if("<"===token)writeTo="<",ltIndex++,commandObject["<"][ltIndex]="";else if("<<"===token)ignoreNextChar=!0,writeTo="<<",ltltIndex++,commandObject["<<"][ltltIndex]="";else{if("|"===token){commandObject["|"]=this.parseCommand(string.substring(i+1));break}if("&&"===token){commandObject["&&"]=this.parseCommand(string.substring(i+2));break}if("||"===token){commandObject["||"]=this.parseCommand(string.substring(i+2));break}}}else{if("command"===writeTo&&(command+=char),">"===writeTo){if(" "===char&&0<commandObject[">"][gtIndex].length&&!this.utils.isBetweenQuotes(string,i)){writeTo="command";continue}/["']/.test(char)||(commandObject[">"][gtIndex]+=char)}if(">>"===writeTo){if(" "===char&&0<commandObject[">>"][gtgtIndex].length&&!this.utils.isBetweenQuotes(string,i)){writeTo="command";continue}/["']/.test(char)||(commandObject[">>"][gtgtIndex]+=char)}if("<"===writeTo){if(" "===char&&0<commandObject["<"][ltIndex].length&&!this.utils.isBetweenQuotes(string,i)){writeTo="command";continue}/["']/.test(char)||(commandObject["<"][ltIndex]+=char)}"<<"===writeTo&&(" "===char&&0<commandObject["<<"][ltltIndex].length&&!this.utils.isBetweenQuotes(string,i)?writeTo="command":/["']/.test(char)||(commandObject["<<"][ltltIndex]+=char))}}return command=command.split(" "),commandObject.name=command.shift(),commandObject.args=this.parseArgs(command.join(" ")),-1===commandObject.args?(commandObject.invalid=!0,commandObject.invalidReason="Unclosed Quote"):commandObject.args=commandObject.args.filter(x=>0<x.trim().length),commandObject[">"]=commandObject[">"].map(str=>str.trim()).filter(x=>0<x.trim().length),commandObject[">>"]=commandObject[">>"].map(str=>str.trim()).filter(x=>0<x.trim().length),commandObject["<"]=commandObject["<"].map(str=>str.trim()).filter(x=>0<x.trim().length),commandObject["<<"]=commandObject["<<"].map(str=>str.trim()).filter(x=>0<x.trim().length),commandObject},this.parseArgs=str=>{str=str.trim();let args=[],currentArg="",doubleQuote=!1,singleQuote=!1;for(let i=0;i<str.length;i++){var char=str[i];'"'!==char||singleQuote?"'"!==char||doubleQuote?" "!==char||doubleQuote||singleQuote?currentArg+=char:(args.push(currentArg),currentArg=""):singleQuote=!singleQuote:doubleQuote=!doubleQuote}return args.push(currentArg),doubleQuote||singleQuote?-1:args}}})},{"./utils":3}],2:[function(require,module,exports){module.exports=(string,inside)=>{let indexes=[];for(let i=0;i<inside.length;i++)inside.substring(i,i+string.length)===string&&indexes.push(i);return indexes}},{}],3:[function(require,module,exports){require={isBetweenQuotes:require("./isBetweenQuotes"),getAllOccurrencesOf:require("./getAllOccurrencesOf"),splitAt:require("./splitAt")};module.exports=require},{"./getAllOccurrencesOf":2,"./isBetweenQuotes":4,"./splitAt":5}],4:[function(require,module,exports){module.exports=(str,index)=>{let singleQuote=!1,doubleQuote=!1,singleClosed=!0,doubleClosed=!0,quoted=!1,indexPassed=!1;for(let i=0;i<str.length;i++){var char=str[i];if('"'!==char||singleQuote||(doubleClosed=!doubleClosed,doubleQuote=!doubleQuote),"'"!==char||doubleQuote||(singleClosed=!singleClosed,singleQuote=!singleQuote),i===index&&(indexPassed=!0,(doubleQuote||singleQuote)&&(quoted=!0)),console.log("char: "+char+" Quoted : "+quoted+" Doublequote: "+doubleQuote+" SingleQuote: "+singleQuote+" SingleClosed: "+singleClosed+" DoubleClosed: "+doubleClosed+" Quoted: "+quoted+" IndexPassed: "+indexPassed),indexPassed&&quoted&&doubleClosed&&singleClosed)return!0}return!1}},{}],5:[function(require,module,exports){module.exports=(indexes,string)=>{let result=[],currentPartIndex=0;return indexes.forEach(index=>{result.push(string.substring(currentPartIndex,index)),currentPartIndex=index+1}),result.push(string.substring(currentPartIndex)),result}},{}]},{},[1])(1)});
